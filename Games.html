<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Games â€“ 3RROR5TUDIOS</title>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- PlayFab SDK -->
<script src="https://download.playfab.com/PlayFabClientSdk.js"></script>

<style>
/* ----------------- TOPBAR ----------------- */
.topbar {
    background: linear-gradient(to right, #35004b, #48006b);
    padding: 15px 25px;
    border-radius: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin: 15px;
}
.topbar-left {
    display: flex;
    gap: 25px;
    align-items: center;
}
.topbar img.logo {
    width: 45px;
    border-radius: 10px;
}
.topbar a {
    color: white;
    font-size: 18px;
    text-decoration: none;
}
.topbar-right {
    display: flex;
    align-items: center;
    gap: 10px;
}
.pfp {
    width: 45px;
    height: 45px;
    border-radius: 50%;
    border: 3px solid gold;
    object-fit: cover;
}
.username {
    color: white;
    font-weight: bold;
    font-size: 18px;
}

/* ----------- GAMES GRID (KEEPING YOUR STYLE) ----------- */
.games-grid {
    margin-top: 20px;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: 25px;
    padding: 20px;
}
.game-card {
    background: #a54acf;
    border-radius: 15px;
    text-align: center;
    padding-bottom: 20px;
}
.game-card img {
    width: 100%;
    height: 350px;
    object-fit: cover;
    border-radius: 10px 10px 0 0;
}
</style>
</head>

<body style="background:#5a009d; color:white;">

<!-- ---------------- TOPBAR ---------------- -->
<div class="topbar">
    <div class="topbar-left">
        <img src="https://i.postimg.cc/W4MBrFys/errorstudioslogo.png" class="logo">
        <a href="/games">Games</a>
        <a href="/errorverse">Errorverse</a>
    </div>
    <div class="topbar-right">
        <img id="playerPFP" class="pfp" src="https://i.imgur.com/GVQ2YPR.png">
        <span id="playerName" class="username">User</span>
    </div>
</div>

<h1 style="text-align:center; font-size:70px; margin-top:50px;">GAMES</h1>
<p style="text-align:center; font-size:22px;">Issues: <span id="issueCount">0</span></p>

<!-- --------------- GAMES GRID --------------- -->
<div id="gamesList" class="games-grid"></div>


<script>
// -------------------------------------------
// PLAYFAB CONFIG
// -------------------------------------------
PlayFab.settings.titleId = "1FC26D";

// Try login with stored player ID or guest login
function loginToPlayFab() {
    let storedID = localStorage.getItem("PlayFabPlayerID");

    let loginPayload = storedID ?
    {
        CustomId: storedID,
        CreateAccount: false
    } :
    {
        CustomId: "User-" + Date.now(),
        CreateAccount: true
    };

    PlayFabClientSDK.LoginWithCustomID(loginPayload, function (result, error) {
        if (result) {
            console.log("PlayFab Login Success:", result);

            localStorage.setItem("PlayFabPlayerID", loginPayload.CustomId);

            getPlayerProfile();   // Load username + PFP
        } else {
            console.log("PlayFab Login Error:", error);
        }
    });
}

// -------------------------------------------
// GET PLAYER PROFILE (username + avatar URL)
// -------------------------------------------
function getPlayerProfile() {
    PlayFabClientSDK.GetPlayerProfile({
        ProfileConstraints: {
            ShowDisplayName: true,
            ShowAvatarUrl: true
        }
    }, function (result, error) {
        if (result) {
            console.log("Profile loaded:", result);

            let profile = result.data.PlayerProfile;

            // Username
            document.getElementById("playerName").textContent =
                profile.DisplayName || "Player";

            // Avatar
            if (profile.AvatarUrl) {
                document.getElementById("playerPFP").src = profile.AvatarUrl;
            }
        }
    });
}


// -------------------------------------------
// LOAD GAMES (uses your backup list)
// -------------------------------------------
const games = [
    {
        name: "The Legend Of Phil A. Buster",
        category: "Roguelike",
        price: "3.49",
        available: false,
        issue: "",
        image: "https://i.postimg.cc/t4FQ384p/phil.png"
    },
    {
        name: "Shadows Behind The Throne",
        category: "Strategy",
        price: "9.99",
        available: false,
        issue: "",
        extra: true,
        image: "https://i.postimg.cc/kGjNdP4q/throne.png"
    },
    {
        name: "WingStormX",
        category: "Racing",
        price: "4.99",
        available: true,
        issue: "Glitchy performance on Xbox ONE",
        image: "https://i.postimg.cc/gkPYtLjt/wingstorm.jpg"
    },
    {
        name: "H3llVector",
        category: "Shooter",
        price: "4.99",
        available: false,
        extra: true,
        image: "https://i.postimg.cc/0NQYrJMc/hellvector.png"
    }
];

// -------------------------------------------
// DISPLAY GAMES
// -------------------------------------------
function loadGames() {
    let container = document.getElementById("gamesList");
    container.innerHTML = "";

    let issueCount = 0;

    games.forEach(g => {
        if (g.issue) issueCount++;

        container.innerHTML += `
        <div class="game-card">
            <img src="${g.image}">
            <h2>${g.name}</h2>
            <p>${g.category} - $${g.price}</p>
            ${g.extra ? `<p style="color:#00FFAA">Included in ERRORVERSE XTRA</p>` : ""}
            ${g.issue ? `<p style="color:yellow">Issue: ${g.issue}</p>` : ""}
            ${g.available ? `<p style="color:#00FF00">AVAILABLE</p>` 
                          : `<p style="color:red">NOT AVAILABLE</p>`}
        </div>`;
    });

    document.getElementById("issueCount").textContent = issueCount;
}


// -------------------------------------------
// INIT PAGE
// -------------------------------------------
loginToPlayFab();
loadGames();

</script>

</body>
</html>
